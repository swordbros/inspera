url = "/event/:id"
layout = "default"
title = "Event Detail"

[eventDetail]
==
{% if event is empty %}
  {% do abort(404) %}
{% endif %}

{% set breadcrumbs = {
  ('Home'|_): ('home'|boxesPage),
  ('Calendar'|_):('event/events'|page)
} %}

<section class="section event-section">
  <div class="container">

    <div class="row">
      <div class="col-lg-6">
        <ul class="breadcrumbs">
          {% for name, url in breadcrumbs %}
            <li>
              <a href="{{ url }}">
                {{ name  }}
              </a>
            </li>        
            /
          {% endfor %}
          {{ event.title }}
        </ul>

        <div class="side-content left">
          <small class="event-category">
            {{ event.event_category.name }}
          </small>
          <h1 class="h2">
            {{ event.title }}
          </h1>
          <p>
            {{ event.short | raw }}
          </p>
          <table>
            <tr>
              <td>{{ 'Start'|_}}: </td>
              <td>{{ carbon(event.start).formatLocalized('%d.%m.%Y') }}</td>
            </tr>
            <tr>
              <td>{{ 'End'|_}}:  </td>
              <td>{{ carbon(event.end).formatLocalized('%d.%m.%Y') }}</td>
            </tr>
            <tr>
              <td>{{ 'Event Category'|_ }}: </td>
              <td>{{ event.event_category.name }}</td>
            </tr>
            <tr>
              <td>{{ 'Venue Name'|_ }}: </td>
              <td>{{ event.event_zone.name }}</td>
            </tr>
          </table>
        </div>
     
        <div class="side-icon-list">
          <ul>
            <li>
              <figure>
                <img src="{{ 'assets/images/clock.png' | theme }}" alt="Opening times">
              </figure>
              <div class="content">
                <div class="h5">
                  {{ 'Opening times' |_ }}
                </div>
                <p>
                  {{ 'From'|_ }} {{ carbon(event.start).formatLocalized('%d.%m') }}<br>
                  {% for item in swordbrosSettings.working_hours %}
                    {{ item.week_days }}: {{ item.time }}
                    {{ not loop.last ? '<br>'|raw }}
                  {% endfor %}
                </p>
              </div>
            </li>
          </ul>
          
          <a data-scroll-to="booking-form" href="#" class="custom-button -primary">
            {{ 'Book now'|_ }}
          </a>
        </div>
      </div>

      <div class="col-lg-6">
        <div class="right-half double-slider-wrapper" data-scroll data-scroll-speed="1">
          <div class="swiper eventSwiper">
            <div class="swiper-wrapper">
              {% for slide in event.images %}
                <div class="swiper-slide">
                  <img src="{{ slide.getThumb(636, 477, {'mode': 'crop'}) }}" alt="{{ slide.title }}"/>
                </div>
              {% endfor %}
            </div>     
          </div>
          <div thumbsSlider="" class="swiper eventSwiperNav">
            <div class="swiper-wrapper">
              {% for slide in event.images %}
                <div class="swiper-slide">
                  <img src="{{ slide.getThumb(636, 477, {'mode': 'crop'}) }}" alt="{{ slide.title }}"/>
                </div>
              {% endfor %}
            </div>
          </div>
          <div class="container-fluid double-slider-nav">
            <div class="button-prev"><i class="far fa-chevron-left"></i></div>
            <div class="button-next"><i class="far fa-chevron-right"></i></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="content-section event-details">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="event-description">
          <h2 class="h3">
            {{ 'Event Details'|_ }}
          </h2>
          {{ event.description | raw }}
        </div>
      </div>
    </div>
    <div class="card-divider"></div>
    <div class="card-body card-lg" id="booking-form">
      {% if event.booking_url %}
        <a class="custom-button -blue" href="{{ event.booking_url }}">
          {{ 'Book Now'|_}}
        </a>
      {% else %}
        {% partial 'event/booking-form' %}
      {% endif %}
    </div>
    <div class="card-divider"></div>
    <div class="card-lg">
        {% partial 'event/comment-list' %}
    </div>
  </div>
</section>


{% put scripts %}
  <script>
    var swiperNav = new Swiper(".eventSwiperNav", {
      //loop: true,
      spaceBetween: 10,
      slidesPerView: 4,
      // freeMode: true,
      watchSlidesProgress: true,      
    });

    new Swiper(".eventSwiper", {
      loop: true,
      //spaceBetween: 10,
      thumbs: {
        swiper: swiperNav,
      },
      navigation: {
        nextEl: '.button-next',
        prevEl: '.button-prev',
      },
    });
  </script>
{% endput %}

{% put styles %}
  <style>
    .event-section {
      --event-type-background: {{ event.event_type.color }};
    }
    .eventSwiper2 {
      height: 80%;
      width: 100%;
      overflow: hidden;
    }
    .eventSwiper {
      height: 20%;
      box-sizing: border-box;
      padding: 10px 0;
      overflow: hidden;
    }
    .eventSwiper .swiper-slide {
      width: 25%;
      height: 100%;
    }
    .eventSwiper2 .swiper-slide-thumb-active {
      opacity: 1;
    }    
  </style>
{% endput %}
